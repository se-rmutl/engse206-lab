# 6.6.3.1 Frontend - Electron Agent Desktop App (Complete Version V3.1 - Final)

‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏â‡∏ö‡∏±‡∏ö‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î‡∏´‡∏≤‡∏¢

## üéØ ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°

**Agent Desktop Application** ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢ **Electron.js + React** ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Backend Server v2.0 ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå

**‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô:** 3.1 (Final - ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏ó‡∏∏‡∏Å‡πÑ‡∏ü‡∏•‡πå)

---

## üìÅ Complete Project Structure

```
agent-desktop/
‚îú‚îÄ‚îÄ üì¶ package.json                 
‚îú‚îÄ‚îÄ üîß .env.example                 
‚îú‚îÄ‚îÄ üö´ .gitignore                   
‚îú‚îÄ‚îÄ ‚ö° main.js                      
‚îú‚îÄ‚îÄ üîí preload.js                   
‚îÇ
‚îú‚îÄ‚îÄ üìù public/
‚îÇ   ‚îú‚îÄ‚îÄ index.html                  ‚úÖ 
‚îÇ   ‚îî‚îÄ‚îÄ assets/
‚îÇ       ‚îú‚îÄ‚îÄ icon.png                
‚îÇ       ‚îú‚îÄ‚îÄ tray-icon.png           
‚îÇ       ‚îî‚îÄ‚îÄ README.txt              
‚îÇ
‚îî‚îÄ‚îÄ ‚öõÔ∏è src/                          
    ‚îú‚îÄ‚îÄ App.js                      ‚úÖ
    ‚îú‚îÄ‚îÄ index.js                    ‚úÖ
    ‚îÇ
    ‚îú‚îÄ‚îÄ components/
    ‚îÇ   ‚îú‚îÄ‚îÄ ErrorBoundary.js        ‚úÖ
    ‚îÇ   ‚îú‚îÄ‚îÄ LoginForm.js            ‚úÖ (NEW - Complete)
    ‚îÇ   ‚îú‚îÄ‚îÄ AgentInfo.js            ‚úÖ (NEW - Complete)
    ‚îÇ   ‚îú‚îÄ‚îÄ StatusPanel.js          ‚úÖ (NEW - Complete)
    ‚îÇ   ‚îî‚îÄ‚îÄ MessagePanel.js         ‚úÖ (NEW - Complete)
    ‚îÇ
    ‚îú‚îÄ‚îÄ services/
    ‚îÇ   ‚îú‚îÄ‚îÄ api.js                  ‚úÖ (NEW - Complete)
    ‚îÇ   ‚îú‚îÄ‚îÄ socket.js               ‚úÖ (NEW - Complete)
    ‚îÇ   ‚îî‚îÄ‚îÄ notifications.js        ‚úÖ (NEW - Complete)
    ‚îÇ
    ‚îú‚îÄ‚îÄ utils/
    ‚îÇ   ‚îú‚îÄ‚îÄ dateUtils.js            ‚úÖ (NEW - Complete)
    ‚îÇ   ‚îú‚îÄ‚îÄ validation.js           ‚úÖ (NEW - Complete)
    ‚îÇ   ‚îî‚îÄ‚îÄ logger.js               ‚úÖ
    ‚îÇ
    ‚îî‚îÄ‚îÄ styles/
        ‚îú‚îÄ‚îÄ App.css                 ‚úÖ (NEW - Complete)
        ‚îî‚îÄ‚îÄ components.css          ‚úÖ (NEW - Complete)
```

---

## üîß ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î‡∏´‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà

### 1. components/LoginForm.js (COMPLETE)

```javascript
import React, { useState, useEffect } from 'react';
import { loginAgent, checkServerHealth } from '../services/api';
import { validateAgentCode } from '../utils/validation';

function LoginForm({ onLogin }) {
  const [agentCode, setAgentCode] = useState('');
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');
  const [serverStatus, setServerStatus] = useState('unknown');

  // Check server health on mount
  useEffect(() => {
    checkHealth();
  }, []);

  const checkHealth = async () => {
    try {
      await checkServerHealth();
      setServerStatus('online');
    } catch (error) {
      setServerStatus('offline');
      setError('Backend server is not running. Please start the server first.');
    }
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    
    // Validate agent code
    const validationError = validateAgentCode(agentCode);
    if (validationError) {
      setError(validationError);
      return;
    }

    setLoading(true);
    setError('');

    try {
      const result = await loginAgent(agentCode.toUpperCase());
      
      if (result.success) {
        // Pass both user data and token to parent
        onLogin(result.data.user, result.data.token);
      } else {
        setError(result.error || 'Login failed');
      }
    } catch (err) {
      console.error('Login error:', err);
      
      if (err.message.includes('fetch')) {
        setError('Cannot connect to server. Please check if backend is running.');
        setServerStatus('offline');
      } else {
        setError(err.message || 'Network error. Please check your connection.');
      }
    } finally {
      setLoading(false);
    }
  };

  const handleRetry = () => {
    setError('');
    checkHealth();
  };

  return (
    <div className="login-container">
      <div className="login-form">
        <div className="login-header">
          <h2>Agent Login</h2>
          <p>Enter your agent code to continue</p>
          
          {/* Server Status Indicator */}
          <div className={`server-status ${serverStatus}`}>
            <span className="status-dot"></span>
            <span>Server: {serverStatus}</span>
          </div>
        </div>
        
        <form onSubmit={handleSubmit}>
          <div className="form-group">
            <label htmlFor="agentCode">Agent Code</label>
            <input
              id="agentCode"
              type="text"
              placeholder="e.g., AG001"
              value={agentCode}
              onChange={(e) => {
                setAgentCode(e.target.value.toUpperCase());
                if (error) setError('');
              }}
              disabled={loading || serverStatus === 'offline'}
              maxLength={5}
              autoFocus
            />
          </div>
          
          <button 
            type="submit" 
            disabled={loading || !agentCode.trim() || serverStatus === 'offline'}
            className="login-btn"
          >
            {loading ? 'Signing in...' : 'Sign In'}
          </button>
          
          {error && (
            <div className="error-message">
              <span>‚ö†Ô∏è</span> {error}
              {serverStatus === 'offline' && (
                <button 
                  type="button" 
                  onClick={handleRetry} 
                  className="retry-btn"
                >
                  Retry Connection
                </button>
              )}
            </div>
          )}
        </form>
        
        <div className="login-footer">
          <p>Sample codes: AG001, AG002, AG003</p>
          <p className="help-text">
            Need help? Check if backend server is running on port 3001
          </p>
        </div>
      </div>
    </div>
  );
}

export default LoginForm;
```

### 2. components/AgentInfo.js (COMPLETE)

```javascript
import React from 'react';

function AgentInfo({ agent, status }) {
  if (!agent) return null;

  const getStatusColor = (status) => {
    const colors = {
      Available: '#4CAF50',
      Busy: '#FF9800',
      Break: '#2196F3',
      Offline: '#9E9E9E'
    };
    return colors[status] || colors.Offline;
  };

  return (
    <div className="agent-info">
      <div className="agent-avatar">
        <span>üë§</span>
      </div>
      
      <div className="agent-details">
        <h3 className="agent-name">{agent.agentName}</h3>
        
        <div className="agent-meta">
          <div className="agent-code">
            <span className="label">Code:</span>
            <span className="value">{agent.agentCode}</span>
          </div>
          
          <div className="agent-team">
            <span className="label">Team:</span>
            <span className="value">{agent.teamName || 'N/A'}</span>
          </div>
        </div>
        
        <div className="agent-status">
          <span 
            className="status-dot"
            style={{ backgroundColor: getStatusColor(status) }}
          ></span>
          <span className="status-text">{status}</span>
        </div>
      </div>
    </div>
  );
}

export default AgentInfo;
```

### 3. components/StatusPanel.js (COMPLETE)

```javascript
import React from 'react';

function StatusPanel({ currentStatus, onStatusChange, disabled = false }) {
  const statuses = [
    { key: 'Available', label: 'Available', color: '#4CAF50', icon: '‚úì' },
    { key: 'Busy', label: 'Busy', color: '#FF9800', icon: '‚è±' },
    { key: 'Break', label: 'Break', color: '#2196F3', icon: '‚òï' },
    { key: 'Offline', label: 'Offline', color: '#9E9E9E', icon: '‚è∏' }
  ];

  return (
    <div className="status-panel">
      <div className="status-header">
        <h3>Status Control</h3>
        <div className="current-status">
          Current: <span className="status-badge" style={{ 
            backgroundColor: statuses.find(s => s.key === currentStatus)?.color 
          }}>
            {currentStatus}
          </span>
        </div>
      </div>
      
      <div className="status-buttons">
        {statuses.map(status => (
          <button
            key={status.key}
            className={`status-btn ${status.key === currentStatus ? 'active' : ''}`}
            onClick={() => onStatusChange(status.key)}
            disabled={disabled}
            style={{ 
              backgroundColor: status.color,
              opacity: disabled ? 0.5 : (status.key === currentStatus ? 1 : 0.8)
            }}
          >
            <span className="status-icon">{status.icon}</span>
            <span className="status-label">{status.label}</span>
          </button>
        ))}
      </div>
      
      {disabled && (
        <div className="status-warning">
          ‚ö†Ô∏è Not connected to server - Status updates unavailable
        </div>
      )}
    </div>
  );
}

export default StatusPanel;
```

### 4. components/MessagePanel.js (COMPLETE)

```javascript
import React, { useEffect, useRef, useState } from 'react';
import { formatTime, getTimeAgo } from '../utils/dateUtils';
import { markMessageAsRead } from '../services/api';

function MessagePanel({ messages, agentCode, loading = false }) {
  const messagesEndRef = useRef(null);
  const [markingRead, setMarkingRead] = useState(new Set());

  const scrollToBottom = () => {
    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
  };

  useEffect(() => {
    scrollToBottom();
  }, [messages]);

  const handleMarkAsRead = async (messageId) => {
    if (markingRead.has(messageId)) return;

    setMarkingRead(prev => new Set(prev).add(messageId));

    try {
      await markMessageAsRead(messageId);
      console.log('Message marked as read:', messageId);
    } catch (error) {
      console.error('Failed to mark message as read:', error);
    } finally {
      setMarkingRead(prev => {
        const newSet = new Set(prev);
        newSet.delete(messageId);
        return newSet;
      });
    }
  };

  const getPriorityColor = (priority) => {
    const colors = {
      high: '#f44336',
      normal: '#2196f3',
      low: '#9e9e9e'
    };
    return colors[priority] || colors.normal;
  };

  const unreadCount = messages.filter(m => !m.isRead).length;

  return (
    <div className="message-panel">
      <div className="message-header">
        <h3>
          Messages ({messages.length})
          {unreadCount > 0 && (
            <span className="unread-badge">{unreadCount} unread</span>
          )}
        </h3>
        
        {messages.length > 0 && (
          <button 
            onClick={scrollToBottom}
            className="scroll-btn"
            title="Scroll to bottom"
          >
            ‚¨áÔ∏è
          </button>
        )}
      </div>
      
      <div className="message-list">
        {loading ? (
          <div className="loading-messages">
            <div className="loading-spinner"></div>
            <p>Loading messages...</p>
          </div>
        ) : messages.length === 0 ? (
          <div className="no-messages">
            <div className="no-messages-icon">üì≠</div>
            <p>No messages yet</p>
            <small>Messages from supervisors will appear here</small>
          </div>
        ) : (
          <>
            {messages.map((message, index) => (
              <div 
                key={message._id || index}
                className={`message-item ${message.type} ${message.isRead ? 'read' : 'unread'}`}
              >
                <div className="message-top">
                  <div className="message-from">
                    <span className="from-label">From:</span>
                    <strong>{message.fromCode}</strong>
                  </div>
                  <div className="message-priority">
                    <span 
                      className="priority-indicator"
                      style={{ backgroundColor: getPriorityColor(message.priority) }}
                      title={`Priority: ${message.priority}`}
                    >
                      {message.priority === 'high' ? 'üî¥' : 
                       message.priority === 'low' ? 'üîµ' : '‚ö™'}
                    </span>
                  </div>
                </div>
                
                <div className="message-content">
                  {message.content}
                </div>
                
                <div className="message-footer">
                  <div className="message-meta">
                    <span className="message-type">
                      {message.type === 'broadcast' ? 'üì¢ Broadcast' : 'üí¨ Direct'}
                    </span>
                    <span className="message-time">
                      {formatTime(message.timestamp)}
                    </span>
                    <span className="time-ago">
                      {getTimeAgo(message.timestamp)}
                    </span>
                  </div>
                  
                  {!message.isRead && (
                    <button
                      className="mark-read-btn"
                      onClick={() => handleMarkAsRead(message._id)}
                      disabled={markingRead.has(message._id)}
                      title="Mark as read"
                    >
                      {markingRead.has(message._id) ? '‚è≥' : '‚úì'}
                    </button>
                  )}
                </div>
              </div>
            ))}
            <div ref={messagesEndRef} />
          </>
        )}
      </div>
    </div>
  );
}

export default MessagePanel;
```

### 5. services/api.js (COMPLETE)

```javascript
const API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:3001/api';
let authToken = null;

export const setAuthToken = (token) => {
  authToken = token;
  console.log('Auth token set');
};

export const clearAuthToken = () => {
  authToken = null;
  console.log('Auth token cleared');
};

export const getAuthToken = () => authToken;

export const loginAgent = async (agentCode) => {
  try {
    const response = await fetch(`${API_BASE_URL}/auth/login`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ agentCode })
    });

    const data = await response.json();
    
    if (!response.ok) {
      throw new Error(data.error || 'Login failed');
    }
    
    if (data.data?.token) {
      setAuthToken(data.data.token);
    }
    
    return data;
  } catch (error) {
    console.error('Login API Error:', error);
    throw error;
  }
};

export const logoutAgent = async () => {
  try {
    const response = await fetch(`${API_BASE_URL}/auth/logout`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${authToken}`
      }
    });

    const data = await response.json();
    clearAuthToken();
    return data;
  } catch (error) {
    console.error('Logout API Error:', error);
    clearAuthToken();
    throw error;
  }
};

export const getMessages = async (agentCode, limit = 50, unreadOnly = false) => {
  try {
    if (!authToken) {
      throw new Error('Not authenticated');
    }

    const url = `${API_BASE_URL}/messages/agent/${agentCode}?limit=${limit}&unreadOnly=${unreadOnly}`;
    const response = await fetch(url, {
      method: 'GET',
      headers: {
        'Authorization': `Bearer ${authToken}`
      }
    });

    const data = await response.json();
    
    if (!response.ok) {
      throw new Error(data.error || 'Failed to get messages');
    }
    
    return data;
  } catch (error) {
    console.error('Get Messages API Error:', error);
    throw error;
  }
};

export const markMessageAsRead = async (messageId) => {
  try {
    if (!authToken) {
      throw new Error('Not authenticated');
    }

    const response = await fetch(`${API_BASE_URL}/messages/${messageId}/read`, {
      method: 'PUT',
      headers: {
        'Authorization': `Bearer ${authToken}`
      }
    });

    const data = await response.json();
    
    if (!response.ok) {
      throw new Error(data.error || 'Failed to mark message as read');
    }
    
    return data;
  } catch (error) {
    console.error('Mark Read API Error:', error);
    throw error;
  }
};

export const updateAgentStatus = async (agentCode, status) => {
  try {
    if (!authToken) {
      throw new Error('Not authenticated');
    }

    const response = await fetch(`${API_BASE_URL}/agents/${agentCode}/status`, {
      method: 'PUT',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${authToken}`
      },
      body: JSON.stringify({ status })
    });

    const data = await response.json();
    
    if (!response.ok) {
      throw new Error(data.error || 'Failed to update status');
    }
    
    return data;
  } catch (error) {
    console.error('Update Status API Error:', error);
    throw error;
  }
};

export const getStatusHistory = async (agentCode, limit = 50) => {
  try {
    if (!authToken) {
      throw new Error('Not authenticated');
    }

    const response = await fetch(`${API_BASE_URL}/agents/${agentCode}/history?limit=${limit}`, {
      method: 'GET',
      headers: {
        'Authorization': `Bearer ${authToken}`
      }
    });

    const data = await response.json();
    
    if (!response.ok) {
      throw new Error(data.error || 'Failed to get status history');
    }
    
    return data;
  } catch (error) {
    console.error('Get Status History API Error:', error);
    throw error;
  }
};

export const checkServerHealth = async () => {
  try {
    const response = await fetch(`${API_BASE_URL.replace('/api', '')}/health`, {
      method: 'GET'
    });

    const data = await response.json();
    
    if (!response.ok) {
      throw new Error('Server health check failed');
    }
    
    return data;
  } catch (error) {
    console.error('Health Check Error:', error);
    throw error;
  }
};
```

### 6. services/socket.js (COMPLETE)

```javascript
import io from 'socket.io-client';

const SOCKET_URL = process.env.REACT_APP_SOCKET_URL || 'http://localhost:3001';
let socket = null;

export const connectSocket = (agentCode) => {
  if (socket) disconnectSocket();

  console.log('Connecting to WebSocket...', SOCKET_URL);

  socket = io(SOCKET_URL, {
    query: { 
      agentCode: agentCode.toUpperCase(), 
      type: 'agent' 
    },
    timeout: 20000,
    reconnection: true,
    reconnectionAttempts: 5,
    reconnectionDelay: 1000,
    reconnectionDelayMax: 5000
  });

  socket.on('connect', () => {
    console.log('WebSocket connected:', socket.id);
    socket.emit('agent_connect', { agentCode: agentCode.toUpperCase() });
  });

  socket.on('disconnect', (reason) => {
    console.log('WebSocket disconnected:', reason);
  });

  socket.on('connect_error', (error) => {
    console.error('WebSocket connection error:', error);
  });

  socket.on('reconnect', (attemptNumber) => {
    console.log('WebSocket reconnected after', attemptNumber, 'attempts');
  });

  socket.on('reconnect_error', (error) => {
    console.error('WebSocket reconnection error:', error);
  });

  socket.on('reconnect_failed', () => {
    console.error('WebSocket reconnection failed after all attempts');
  });

  socket.on('connection_error', (error) => {
    console.error('Connection error from server:', error);
  });

  socket.on('status_error', (error) => {
    console.error('Status update error from server:', error);
  });

  socket.on('message_error', (error) => {
    console.error('Message error from server:', error);
  });

  window.socket = socket;
  return socket;
};

export const disconnectSocket = () => {
  if (socket) {
    console.log('Disconnecting WebSocket...');
    socket.disconnect();
    socket = null;
    window.socket = null;
  }
};

export const sendStatusUpdate = (agentCode, status) => {
  if (socket && socket.connected) {
    console.log('Sending status update via WebSocket:', { agentCode, status });
    socket.emit('update_status', {
      agentCode: agentCode.toUpperCase(),
      status: status
    });
    return true;
  }
  console.warn('Socket not connected, cannot send status update');
  return false;
};

export const isSocketConnected = () => {
  return socket && socket.connected;
};

export const getSocket = () => socket;
```

### 7. services/notifications.js (COMPLETE)

```javascript
export const showDesktopNotification = async (title, body) => {
  try {
    if (window.electronAPI && window.electronAPI.showNotification) {
      await window.electronAPI.showNotification(title, body);
      return;
    }
    
    if ('Notification' in window && Notification.permission === 'granted') {
      new Notification(title, {
        body,
        icon: '/assets/icon.png',
        badge: '/assets/tray-icon.png'
      });
    }
  } catch (error) {
    console.error('Notification error:', error);
  }
};

export const requestNotificationPermission = async () => {
  if ('Notification' in window && Notification.permission === 'default') {
    const permission = await Notification.requestPermission();
    console.log('Notification permission:', permission);
    return permission;
  }
  return Notification.permission;
};
```

### 8. utils/validation.js (COMPLETE)

```javascript
export const validateAgentCode = (code) => {
  if (!code) {
    return 'Agent code is required';
  }
  
  const trimmed = code.trim().toUpperCase();
  
  if (trimmed.length === 0) {
    return 'Agent code cannot be empty';
  }
  
  if (!/^[A-Z]{2}\d{3}$/.test(trimmed)) {
    return 'Agent code must be in format: AG001 or SP001';
  }
  
  return null;
};

export const validateMessage = (content) => {
  if (!content || content.trim().length === 0) {
    return 'Message cannot be empty';
  }
  
  if (content.length > 500) {
    return 'Message is too long (max 500 characters)';
  }
  
  return null;
};
```

### 9. utils/dateUtils.js (COMPLETE)

```javascript
export const formatTime = (timestamp) => {
  try {
    return new Date(timestamp).toLocaleTimeString('en-US', {
      hour: '2-digit',
      minute: '2-digit',
      hour12: false
    });
  } catch {
    return '--:--';
  }
};

export const formatDateTime = (timestamp) => {
  try {
    return new Date(timestamp).toLocaleString('en-US', {
      year: 'numeric',
      month: 'short',
      day: 'numeric',
      hour: '2-digit',
      minute: '2-digit',
      hour12: false
    });
  } catch {
    return 'Invalid date';
  }
};

export const getTimeAgo = (timestamp) => {
  try {
    const now = new Date();
    const time = new Date(timestamp);
    const diffInSeconds = Math.floor((now - time) / 1000);
    
    if (diffInSeconds < 60) {
      return 'just now';
    }
    
    const diffInMinutes = Math.floor(diffInSeconds / 60);
    if (diffInMinutes < 60) {
      return `${diffInMinutes}m ago`;
    }
    
    const diffInHours = Math.floor(diffInMinutes / 60);
    if (diffInHours < 24) {
      return `${diffInHours}h ago`;
    }
    
    const diffInDays = Math.floor(diffInHours / 24);
    if (diffInDays < 7) {
      return `${diffInDays}d ago`;
    }
    
    const diffInWeeks = Math.floor(diffInDays / 7);
    return `${diffInWeeks}w ago`;
  } catch {
    return 'unknown';
  }
};

export const getDuration = (start, end) => {
  try {
    const startTime = new Date(start);
    const endTime = new Date(end);
    return Math.floor((endTime - startTime) / 1000);
  } catch {
    return 0;
  }
};
```

### 10. styles/App.css (COMPLETE)

```css
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

.app {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  max-width: 400px;
  margin: 0 auto;
  background: #f5f5f5;
  min-height: 100vh;
}

/* Connection Status Bar */
.connection-status {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px;
  font-size: 12px;
  font-weight: 500;
  color: white;
  transition: background-color 0.3s;
}

.connection-status.connected { 
  background: #4caf50; 
}

.connection-status.disconnected { 
  background: #9e9e9e; 
}

.connection-status.error { 
  background: #f44336; 
}

.status-indicator {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: currentColor;
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

/* Error Banner */
.error-banner {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: #f44336;
  color: white;
  padding: 12px 16px;
  font-size: 14px;
  animation: slideDown 0.3s ease-out;
}

@keyframes slideDown {
  from {
    transform: translateY(-100%);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

.error-close {
  background: none;
  border: none;
  color: white;
  font-size: 20px;
  cursor: pointer;
  padding: 0;
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  transition: background-color 0.2s;
}

.error-close:hover {
  background: rgba(255, 255, 255, 0.2);
}

/* Login Container */
.login-container {
  padding: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.login-form {
  background: white;
  padding: 40px 30px;
  border-radius: 16px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.2);
  width: 100%;
  max-width: 320px;
  animation: fadeIn 0.5s ease-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.login-header {
  text-align: center;
  margin-bottom: 30px;
}

.login-header h2 {
  margin: 0 0 8px 0;
  color: #333;
  font-size: 24px;
}

.login-header p {
  color: #666;
  font-size: 14px;
  margin: 0;
}

/* Server Status in Login */
.server-status {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 11px;
  font-weight: 600;
  margin-top: 12px;
  text-transform: uppercase;
}

.server-status.online {
  background: #e8f5e9;
  color: #2e7d32;
}

.server-status.offline {
  background: #ffebee;
  color: #c62828;
}

.server-status.unknown {
  background: #fff3e0;
  color: #f57c00;
}

.server-status .status-dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: currentColor;
  animation: blink 2s infinite;
}

@keyframes blink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.3; }
}

/* Form Elements */
.form-group {
  margin-bottom: 20px;
  text-align: left;
}

.form-group label {
  display: block;
  margin-bottom: 8px;
  font-weight: 600;
  color: #333;
  font-size: 14px;
}

.form-group input {
  width: 100%;
  padding: 12px 16px;
  border: 2px solid #e0e0e0;
  border-radius: 8px;
  font-size: 16px;
  transition: border-color 0.3s;
  font-family: monospace;
  letter-spacing: 1px;
}

.form-group input:focus {
  outline: none;
  border-color: #667eea;
}

.form-group input:disabled {
  background: #f5f5f5;
  cursor: not-allowed;
}

/* Buttons */
.login-btn {
  width: 100%;
  padding: 14px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
}

.login-btn:hover:not(:disabled) {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
}

.login-btn:active:not(:disabled) {
  transform: translateY(0);
}

.login-btn:disabled {
  background: #ccc;
  cursor: not-allowed;
  transform: none;
}

/* Error Message */
.error-message {
  margin-top: 16px;
  padding: 12px;
  background: #ffebee;
  border: 1px solid #ffcdd2;
  border-radius: 8px;
  color: #c62828;
  font-size: 13px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  animation: shake 0.5s;
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-5px); }
  75% { transform: translateX(5px); }
}

.retry-btn {
  margin-top: 8px;
  padding: 6px 12px;
  background: #c62828;
  color: white;
  border: none;
  border-radius: 4px;
  font-size: 12px;
  cursor: pointer;
  width: 100%;
}

.retry-btn:hover {
  background: #b71c1c;
}

/* Login Footer */
.login-footer {
  margin-top: 20px;
  text-align: center;
}

.login-footer p {
  color: #999;
  font-size: 12px;
  margin: 6px 0;
}

.help-text {
  color: #666 !important;
  font-size: 11px !important;
}

/* Dashboard */
.dashboard {
  background: white;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

.dashboard-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 20px;
  border-bottom: 1px solid #e0e0e0;
  background: white;
}

.logout-btn {
  background: #f44336;
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  font-weight: 600;
  transition: background-color 0.2s, transform 0.2s;
}

.logout-btn:hover {
  background: #d32f2f;
  transform: translateY(-1px);
}

.logout-btn:active {
  transform: translateY(0);
}

/* Loading Spinner */
.loading-spinner {
  width: 40px;
  height: 40px;
  border: 4px solid #f3f3f3;
  border-top: 4px solid #667eea;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto 16px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
```

### 11. styles/components.css (COMPLETE)

```css
/* Agent Info Component */
.agent-info {
  display: flex;
  gap: 12px;
  flex: 1;
}

.agent-avatar {
  width: 48px;
  height: 48px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  flex-shrink: 0;
}

.agent-details {
  flex: 1;
  min-width: 0;
}

.agent-name {
  margin: 0 0 4px 0;
  font-size: 16px;
  font-weight: 600;
  color: #333;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.agent-meta {
  display: flex;
  gap: 16px;
  margin-bottom: 6px;
  font-size: 12px;
  color: #666;
}

.agent-meta > div {
  display: flex;
  gap: 4px;
}

.agent-meta .label {
  font-weight: 500;
}

.agent-meta .value {
  font-weight: 600;
  color: #333;
}

.agent-status {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 13px;
}

.agent-status .status-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  flex-shrink: 0;
}

.agent-status .status-text {
  font-weight: 600;
}

/* Status Panel Component */
.status-panel {
  padding: 20px;
  border-bottom: 1px solid #e0e0e0;
  background: #fafafa;
}

.status-header {
  margin-bottom: 16px;
}

.status-header h3 {
  margin: 0 0 8px 0;
  font-size: 16px;
  font-weight: 600;
  color: #333;
}

.current-status {
  font-size: 13px;
  color: #666;
}

.status-badge {
  padding: 4px 10px;
  border-radius: 12px;
  color: white;
  font-size: 12px;
  font-weight: 600;
  margin-left: 6px;
}

.status-buttons {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
}

.status-btn {
  padding: 16px 12px;
  border: none;
  border-radius: 10px;
  color: white;
  font-weight: 600;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.status-btn:hover:not(:disabled) {
  transform: translateY(-2px);
  box-shadow: 0 4px 16px rgba(0,0,0,0.2);
}

.status-btn:active:not(:disabled) {
  transform: translateY(0);
}

.status-btn.active {
  box-shadow: 0 0 0 3px rgba(255,255,255,0.5);
  transform: scale(1.05);
}

.status-btn:disabled {
  cursor: not-allowed;
  opacity: 0.5;
}

.status-icon {
  font-size: 18px;
}

.status-label {
  font-size: 13px;
}

.status-warning {
  margin-top: 12px;
  padding: 10px;
  background: #fff3cd;
  border: 1px solid #ffc107;
  border-radius: 8px;
  color: #856404;
  font-size: 12px;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}

/* Message Panel Component */
.message-panel {
  flex: 1;
  display: flex;
  flex-direction: column;
  background: white;
  overflow: hidden;
}

.message-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 20px;
  border-bottom: 1px solid #e0e0e0;
  background: white;
  position: sticky;
  top: 0;
  z-index: 10;
}

.message-header h3 {
  margin: 0;
  font-size: 16px;
  font-weight: 600;
  color: #333;
  display: flex;
  align-items: center;
  gap: 8px;
}

.unread-badge {
  background: #f44336;
  color: white;
  padding: 2px 8px;
  border-radius: 10px;
  font-size: 11px;
  font-weight: 600;
}

.scroll-btn {
  background: #f0f0f0;
  border: none;
  border-radius: 50%;
  width: 32px;
  height: 32px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background-color 0.2s, transform 0.2s;
}

.scroll-btn:hover {
  background: #e0e0e0;
  transform: scale(1.1);
}

.message-list {
  flex: 1;
  overflow-y: auto;
  padding: 16px 20px;
  background: #fafafa;
}

.message-list::-webkit-scrollbar {
  width: 6px;
}

.message-list::-webkit-scrollbar-track {
  background: #f1f1f1;
}

.message-list::-webkit-scrollbar-thumb {
  background: #888;
  border-radius: 3px;
}

.message-list::-webkit-scrollbar-thumb:hover {
  background: #555;
}

/* Loading Messages */
.loading-messages {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 40px 20px;
  color: #999;
}

.loading-messages p {
  margin-top: 16px;
  font-size: 14px;
}

/* No Messages */
.no-messages {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 60px 20px;
  color: #999;
  text-align: center;
}

.no-messages-icon {
  font-size: 48px;
  margin-bottom: 16px;
  opacity: 0.5;
}

.no-messages p {
  font-size: 16px;
  margin: 8px 0;
  font-weight: 500;
}

.no-messages small {
  font-size: 13px;
  color: #bbb;
}

/* Message Item */
.message-item {
  background: white;
  border: 1px solid #e9ecef;
  border-radius: 12px;
  padding: 14px;
  margin-bottom: 12px;
  transition: transform 0.2s, box-shadow 0.2s;
  animation: messageSlideIn 0.3s ease-out;
}

@keyframes messageSlideIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.message-item.unread {
  border-left: 4px solid #2196f3;
  background: #e3f2fd;
  box-shadow: 0 2px 8px rgba(33, 150, 243, 0.1);
}

.message-item.broadcast {
  border-left: 4px solid #ff9800;
}

.message-item.broadcast.unread {
  background: #fff8e1;
}

.message-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.message-top {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.message-from {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 13px;
  color: #666;
}

.message-from strong {
  color: #333;
  font-weight: 600;
}

.message-priority {
  display: flex;
  align-items: center;
}

.priority-indicator {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
}

.message-content {
  color: #333;
  font-size: 14px;
  line-height: 1.5;
  margin-bottom: 10px;
  word-wrap: break-word;
}

.message-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.message-meta {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 11px;
  color: #999;
  flex-wrap: wrap;
}

.message-type {
  padding: 2px 6px;
  background: #f5f5f5;
  border-radius: 4px;
  font-weight: 500;
}

.message-time {
  font-weight: 500;
}

.time-ago {
  color: #bbb;
}

.mark-read-btn {
  background: #4caf50;
  color: white;
  border: none;
  border-radius: 50%;
  width: 28px;
  height: 28px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  transition: background-color 0.2s, transform 0.2s;
}

.mark-read-btn:hover:not(:disabled) {
  background: #45a049;
  transform: scale(1.1);
}

.mark-read-btn:disabled {
  background: #ccc;
  cursor: not-allowed;
}

/* Responsive Design */
@media (max-width: 350px) {
  .status-buttons {
    grid-template-columns: 1fr;
  }
  
  .agent-meta {
    flex-direction: column;
    gap: 4px;
  }
}
```

---

## ‚úÖ Quick Start Guide

### 1. ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Dependencies

```bash
cd agent-desktop
npm install
```

### 2. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå .env

```bash
cp .env.example .env
```

### 3. ‡∏™‡∏£‡πâ‡∏≤‡∏á Placeholder Icons

```bash
mkdir -p public/assets
curl -L -o public/assets/icon.png "https://placehold.co/256x256/667eea/FFFFFF.png?text=Agent"
curl -L -o public/assets/tray-icon.png "https://placehold.co/32x32/667eea/FFFFFF.png?text=A"
```

### 4. ‡πÄ‡∏£‡∏¥‡πà‡∏° Backend (Terminal 1)

```bash
cd backend-server
npm run dev
```

### 5. ‡πÄ‡∏£‡∏¥‡πà‡∏° Agent Desktop (Terminal 2)

```bash
cd agent-desktop
npm run electron-dev
```

---

## üìã Final Checklist

### ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ:
- [x] package.json
- [x] .env.example
- [x] .gitignore
- [x] main.js
- [x] preload.js
- [x] public/index.html
- [x] public/assets/icon.png
- [x] public/assets/tray-icon.png
- [x] src/App.js
- [x] src/index.js
- [x] src/components/ErrorBoundary.js
- [x] src/components/LoginForm.js
- [x] src/components/AgentInfo.js
- [x] src/components/StatusPanel.js
- [x] src/components/MessagePanel.js
- [x] src/services/api.js
- [x] src/services/socket.js
- [x] src/services/notifications.js
- [x] src/utils/dateUtils.js
- [x] src/utils/validation.js
- [x] src/utils/logger.js
- [x] src/styles/App.css
- [x] src/styles/components.css

### ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Backend:
- [x] `/api/auth/login` - Login API
- [x] `/api/messages/agent/:agentCode` - Get messages
- [x] `/api/messages/:messageId/read` - Mark as read
- [x] `/api/agents/:agentCode/status` - Update status
- [x] WebSocket events - Real-time communication

---

**Agent Desktop App V3.1 Final ‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡πÅ‡∏•‡πâ‡∏ß - ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô 100%**