# Use Case Specifications - EcoTrack System
**Carbon Footprint Tracking System**

## บทนำ

เอกสารนี้นำเสนอ Use Case Diagram ที่มีความละเอียดครบถ้วนสำหรับระบบ EcoTrack ตามข้อมูลจาก Requirements Analysis Document เพื่อใช้ประกอบการสอนและการพัฒนาระบบจริง

---

## การวิเคราะห์ Actors จาก Personas

จากการวิเคราะห์ 3 Personas หลัก เราสามารถกำหนด Actors ของระบบได้ดังนี้:

### Primary Actors (ผู้ใช้หลัก)
- **Student (นักศึกษา)** - ตัวแทนโดย "น้องเกม"
- **Staff (บุคลากร)** - ตัวแทนโดย "พี่พลอย"
- **System Administrator** - ตัวแทนโดย "คุณแอน"

### Secondary Actors (ระบบภายนอก)
- **University SSO System** - ระบบ Single Sign-On ของมหาวิทยาลัย
- **Calculation Engine** - ระบบคำนวณ Carbon Footprint

---

## UC-01: Authenticate User
**Primary Actor:** Student, Staff  
**Secondary Actor:** University SSO System  
**Brief Description:** ผู้ใช้เข้าสู่ระบบผ่านบัญชีมหาวิทยาลัย

### Preconditions:
- ผู้ใช้มีบัญชีนักศึกษาหรือบุคลากรของมหาวิทยาลัย
- ระบบ SSO ของมหาวิทยาลัยทำงานปกติ

### Main Success Scenario:
1. ผู้ใช้เปิดแอปพลิเคชัน EcoTrack
2. ระบบแสดงหน้า Login และปุ่ม "Sign in with University Account"
3. ผู้ใช้คลิกปุ่มเข้าสู่ระบบ
4. ระบบ redirect ไปยังหน้า SSO ของมหาวิทยาลัย
5. ผู้ใช้กรอก username และ password ของมหาวิทยาลัย
6. ระบบ SSO ตรวจสอบข้อมูลและส่งกลับ authentication token
7. ระบบตรวจสอบสิทธิ์และสร้าง session
8. **หากเป็นผู้ใช้ใหม่:** ระบบสร้างโปรไฟล์ใหม่ด้วยข้อมูลจาก SSO
9. ระบบนำผู้ใช้ไปยังหน้า Dashboard

### Alternative Flows:
**3a. Authentication Failed:**
- 3a.1 ระบบ SSO ส่งกลับข้อผิดพลาด
- 3a.2 ระบบแสดงข้อความ "ไม่สามารถเข้าสู่ระบบได้ กรุณาลองใหม่"
- 3a.3 กลับไปที่ขั้นตอนที่ 2

**4a. SSO Service Unavailable:**
- 4a.1 ระบบไม่สามารถเชื่อมต่อ SSO ได้
- 4a.2 แสดงข้อความ "ระบบขัดข้อง กรุณาลองใหม่ภายหลัง"

### Postconditions:
- ผู้ใช้เข้าสู่ระบบสำเร็จ
- ระบบมี active session สำหรับผู้ใช้
- ผู้ใช้สามารถเข้าถึงฟังก์ชันต่างๆ ของระบบได้

---

## UC-02: Log Transportation Activity
**Primary Actor:** Student, Staff  
**Secondary Actor:** Calculation Engine  
**Brief Description:** ผู้ใช้บันทึกข้อมูลการเดินทางประจำวัน

### Preconditions:
- ผู้ใช้เข้าสู่ระบบแล้ว
- มีข้อมูล emission factors ในระบบ

### Main Success Scenario:
1. ผู้ใช้เลือกเมนู "บันทึกการเดินทาง"
2. ระบบแสดงฟอร์มบันทึกการเดินทาง
3. ผู้ใช้เลือกประเภทการเดินทาง (เดิน, จักรยาน, รถยนต์, รถประจำทาง, BTS/MRT)
4. ผู้ใช้กรอกระยะทางเป็นกิโลเมตร
5. ผู้ใช้เลือกวันที่ (default: วันนี้)
6. ผู้ใช้คลิก "บันทึก"
7. ระบบตรวจสอบความถูกต้องของข้อมูล
8. ระบบส่งข้อมูลไปยัง Calculation Engine
9. Calculation Engine คำนวณ CO2 equivalent
10. ระบบบันทึกข้อมูลลงฐานข้อมูล
11. ระบบแสดงผลการคำนวณทันที
12. ระบบอัพเดทคะแนน/แต้มของผู้ใช้

### Alternative Flows:
**7a. Invalid Data:**
- 7a.1 ระยะทางน้อยกว่าหรือเท่ากับ 0
- 7a.2 แสดงข้อความ "กรุณากรอกระยะทางที่มากกว่า 0"
- 7a.3 กลับไปที่ขั้นตอนที่ 4

**7b. Excessive Distance:**
- 7b.1 ระยะทางมากกว่า 1000 กม.
- 7b.2 แสดง confirmation dialog "ระยะทางมากผิดปกติ ต้องการบันทึกหรือไม่?"
- 7b.3 หากผู้ใช้ยืนยัน ดำเนินการต่อ

### Postconditions:
- ข้อมูลการเดินทางถูกบันทึกในระบบ
- ค่า Carbon Footprint ถูกคำนวณและบันทึก
- คะแนนผู้ใช้ถูกอัพเดท
- ข้อมูลปรากฏใน Dashboard

---

## UC-03: Log Energy Usage
**Primary Actor:** Student, Staff  
**Secondary Actor:** Calculation Engine  
**Brief Description:** ผู้ใช้บันทึกข้อมูลการใช้พลังงาน (ไฟฟ้า, น้ำ)

### Preconditions:
- ผู้ใช้เข้าสู่ระบบแล้ว
- ผู้ใช้มีข้อมูลการใช้พลังงานจากมิเตอร์หรือบิล

### Main Success Scenario:
1. ผู้ใช้เลือกเมนู "บันทึกการใช้พลังงาน"
2. ระบบแสดงฟอร์มบันทึกพลังงาน
3. ผู้ใช้เลือกประเภท (ไฟฟ้า หรือ น้ำประปา)
4. ผู้ใช้กรอกจำนวนหน่วยที่ใช้
5. ผู้ใช้เลือกเดือน/ปี ที่บันทึก
6. ผู้ใช้คลิก "บันทึก"
7. ระบบตรวจสอบความถูกต้องของข้อมูล
8. ระบบคำนวณ CO2 equivalent
9. ระบบบันทึกข้อมูลลงฐานข้อมูล
10. ระบบแสดงผลการคำนวณและเปรียบเทียบกับเดือนก่อน
11. ระบบอัพเดทคะแนนผู้ใช้

### Alternative Flows:
**7a. Duplicate Entry:**
- 7a.1 มีข้อมูลของเดือนนั้นอยู่แล้ว
- 7a.2 แสดง dialog "มีข้อมูลเดือนนี้แล้ว ต้องการแทนที่หรือไม่?"
- 7a.3 หากผู้ใช้ยืนยัน อัพเดทข้อมูลเดิม

**8a. Calculation Error:**
- 8a.1 Calculation Engine ส่งกลับข้อผิดพลาด
- 8a.2 บันทึกข้อมูลดิบไว้ก่อน
- 8a.3 แสดงข้อความ "บันทึกแล้ว แต่ยังคำนวณไม่ได้ จะอัพเดทภายหลัง"

### Postconditions:
- ข้อมูลการใช้พลังงานถูกบันทึก
- ค่า CO2 ถูกคำนวณและบันทึก
- ข้อมูลแสดงใน Dashboard และรายงาน

---

## UC-05: View Personal Dashboard
**Primary Actor:** Student, Staff  
**Brief Description:** ผู้ใช้ดู Dashboard ข้อมูล Carbon Footprint ส่วนตัว

### Preconditions:
- ผู้ใช้เข้าสู่ระบบแล้ว
- ผู้ใช้มีข้อมูลกิจกรรมบางส่วนในระบบ

### Main Success Scenario:
1. ผู้ใช้เข้าหน้า Dashboard (หน้าแรกหลัง login)
2. ระบบดึงข้อมูล Carbon Footprint ของผู้ใช้
3. ระบบแสดงสรุปข้อมูลวันนี้:
   - ยอดรวม CO2e วันนี้
   - สัดส่วนจากแต่ละกิจกรรม (Pie Chart)
   - เปรียบเทียบกับเฉลี่ยสัปดาห์ก่อน
4. ระบบแสดงข้อมูลสัปดาห์นี้:
   - กราฟแท่งรายวัน (7 วัน)
   - Trend line แสดงแนวโน้ม
5. ระบบแสดงข้อมูล Gamification:
   - คะแนนสะสม
   - Level ปัจจุบัน
   - อันดับใน Leaderboard
   - Badges ที่ได้รับล่าสุด
6. ระบบแสดงเป้าหมายส่วนตัว (ถ้ามี):
   - Progress Bar
   - วันที่เหลือ
   - สถานะ (On track / Behind / Achieved)

### Alternative Flows:
**2a. No Data Available:**
- 2a.1 ผู้ใช้ใหม่ยังไม่มีข้อมูล
- 2a.2 แสดง welcome message และปุ่ม "เริ่มบันทึกข้อมูล"
- 2a.3 เมื่อคลิก ไปที่หน้าบันทึกกิจกรรม

**2b. Data Loading Error:**
- 2b.1 ระบบไม่สามารถดึงข้อมูลได้
- 2b.2 แสดงข้อความ "ไม่สามารถโหลดข้อมูลได้" พร้อมปุ่ม Refresh

### Postconditions:
- ผู้ใช้เห็นสถานะ Carbon Footprint ปัจจุบัน
- ผู้ใช้เข้าใจแนวโน้มการใช้งาน
- ผู้ใช้มีแรงจูงใจในการปรับปรุง

---

## UC-08: View Leaderboard
**Primary Actor:** Student, Staff  
**Brief Description:** ผู้ใช้ดู Leaderboard และเปรียบเทียบผลงานกับผู้อื่น

### Preconditions:
- ผู้ใช้เข้าสู่ระบบแล้ว
- มีผู้ใช้อื่นในระบบที่มีข้อมูล

### Main Success Scenario:
1. ผู้ใช้เลือกเมนู "Leaderboard"
2. ระบบแสดงตัวเลือกการกรอง:
   - ทั้งมหาวิทยาลัย / คณะของฉัน / แผนกของฉัน
   - รายเดือน / รายสัปดาห์ / ตลอดกาล
3. ผู้ใช้เลือกตัวกรองที่ต้องการ
4. ระบบดึงข้อมูลและจัดอันดับผู้ใช้
5. ระบบแสดง Leaderboard โดยแสดง:
   - อันดับที่ 1-10
   - ชื่อผู้ใช้ (ซ่อนข้อมูลส่วนตัว)
   - คะแนนรวม
   - จำนวน Badges
6. ระบบไฮไลท์ตำแหน่งของผู้ใช้ปัจจุบัน
7. ระบบแสดงสถิติส่วนตัว:
   - อันดับปัจจุบัน
   - คะแนนต่างจากอันดับถัดไป
   - ความก้าวหน้าจากสัปดาห์ก่อน

### Alternative Flows:
**4a. Insufficient Data:**
- 4a.1 ผู้ใช้น้อยกว่า 3 คน
- 4a.2 แสดงข้อความ "ยังมีผู้ใช้น้อยเกินไป จะแสดงเมื่อมีผู้ใช้มากกว่า 3 คน"

**6a. User Not Ranked:**
- 6a.1 ผู้ใช้ยังไม่มีข้อมูลเพียงพอ
- 6a.2 แสดงข้อความ "บันทึกข้อมูลอย่างน้อย 7 วัน เพื่อเข้าร่วม Leaderboard"

### Postconditions:
- ผู้ใช้เห็นตำแหน่งของตนเองเทียบกับผู้อื่น
- ผู้ใช้มีแรงจูงใจในการแข่งขัน
- ระบบเก็บ log การเข้าชม leaderboard

---

## UC-11: Access Admin Dashboard
**Primary Actor:** System Administrator  
**Brief Description:** ผู้ดูแลระบบเข้าถึง Dashboard สำหรับจัดการระบบ

### Preconditions:
- ผู้ใช้มีสิทธิ์ Admin
- ผู้ใช้เข้าสู่ระบบด้วยบัญชี Admin

### Main Success Scenario:
1. Admin เข้าสู่ระบบด้วยบัญชีที่มีสิทธิ์
2. ระบบตรวจสอบสิทธิ์ Admin
3. ระบบแสดง Admin Dashboard ประกอบด้วย:
   - สถิติภาพรวมระบบ (วันนี้):
     * จำนวนผู้ใช้ที่ Active
     * จำนวนกิจกรรมที่บันทึกวันนี้
     * ยอดรวม CO2e ทั้งมหาวิทยาลัย
   - กราฟแสดงแนวโน้ม (30 วันล่าสุด):
     * จำนวนผู้ใช้ใหม่ต่อวัน
     * จำนวนกิจกรรมที่บันทึกต่อวัน
     * ยอดรวม CO2e ต่อวัน
   - Top 5 คณะที่มีผลงานดีที่สุด
   - รายการ Alert/Warning (ถ้ามี)
4. ระบบแสดงเมนูการจัดการ:
   - จัดการผู้ใช้
   - จัดการ Emission Factors
   - สร้างรายงาน
   - ตั้งค่าระบบ

### Alternative Flows:
**2a. Access Denied:**
- 2a.1 ผู้ใช้ไม่มีสิทธิ์ Admin
- 2a.2 แสดงข้อความ "คุณไม่มีสิทธิ์เข้าถึงหน้านี้"
- 2a.3 Redirect กลับไปหน้า Dashboard ปกติ

**3a. Data Loading Error:**
- 3a.1 ไม่สามารถดึงข้อมูลสถิติได้
- 3a.2 แสดงข้อความแจ้งเตือนและปุ่ม Refresh
- 3a.3 แสดงเมนูการจัดการให้ใช้งานได้

### Postconditions:
- Admin เข้าถึงข้อมูลภาพรวมของระบบ
- Admin สามารถนำไปสู่การจัดการระบบได้
- ระบบ log การเข้าถึงของ Admin

---

## UC-12: Generate System Reports
**Primary Actor:** System Administrator  
**Brief Description:** Admin สร้างรายงานสรุปของระบบเพื่อนำเสนอผู้บริหาร

### Preconditions:
- ผู้ใช้มีสิทธิ์ Admin
- ระบบมีข้อมูลที่เพียงพอสำหรับสร้างรายงาน

### Main Success Scenario:
1. Admin เข้าหน้า "สร้างรายงาน"
2. ระบบแสดงตัวเลือกประเภทรายงาน:
   - รายงานภาพรวมมหาวิทยาลัย
   - รายงานเปรียบเทียบคณะ
   - รายงานแนวโน้มรายเดือน
   - รายงานการใช้งานระบบ
3. Admin เลือกประเภทรายงานที่ต้องการ
4. ระบบแสดงตัวเลือกช่วงเวลา:
   - เดือนนี้ / เดือนที่แล้ว
   - ไตรมาสนี้ / ไตรมาสที่แล้ว
   - ปีนี้ / ปีที่แล้ว
   - กำหนดเองระหว่างวันที่
5. Admin เลือกช่วงเวลาและคลิก "สร้างรายงาน"
6. ระบบประมวลผลข้อมูลและสร้างรายงาน
7. ระบบแสดงตัวอย่างรายงานบนหน้าจอ
8. ระบบเสนอตัวเลือกการส่งออก:
   - PDF สำหรับพิมพ์
   - Excel สำหรับวิเคราะห์เพิ่มเติม
   - PowerPoint สำหรับนำเสนอ
9. Admin เลือกรูปแบบและคลิก "ดาวน์โหลด"
10. ระบบสร้างไฟล์และส่งให้ Admin

### Alternative Flows:
**6a. Insufficient Data:**
- 6a.1 ข้อมูลในช่วงที่เลือกไม่เพียงพอ
- 6a.2 แสดงข้อความ "ข้อมูลไม่เพียงพอสำหรับช่วงเวลานี้"
- 6a.3 แนะนำช่วงเวลาที่มีข้อมูลเพียงพอ

**6b. Processing Error:**
- 6b.1 เกิดข้อผิดพลาดในการประมวลผล
- 6b.2 แสดงข้อความ "ไม่สามารถสร้างรายงานได้ กรุณาลองใหม่"
- 6b.3 เก็บ error log สำหรับ debugging

**10a. File Generation Failed:**
- 10a.1 ไม่สามารถสร้างไฟล์ export ได้
- 10a.2 แสดงรายงานบนหน้าจอให้ Admin ดูแทน
- 10a.3 แนะนำให้ลองรูปแบบอื่น

### Postconditions:
- Admin ได้รับรายงานที่ต้องการ
- รายงานสามารถนำไปใช้งานต่อได้
- ระบบเก็บ log การสร้างรายงาน

---

## UC-06: View Carbon Reports
**Primary Actor:** Student, Staff  
**Brief Description:** ผู้ใช้ดูรายงาน Carbon Footprint ส่วนตัวแบบละเอียด

### Preconditions:
- ผู้ใช้เข้าสู่ระบบแล้ว
- ผู้ใช้มีข้อมูลอย่างน้อย 1 สัปดาห์

### Main Success Scenario:
1. ผู้ใช้เลือกเมนู "รายงานของฉัน"
2. ระบบแสดงตัวเลือกประเภทรายงาน:
   - รายงานรายสัปดาห์
   - รายงานรายเดือน
   - รายงานเปรียบเทียบ
3. ผู้ใช้เลือกประเภทที่ต้องการ
4. ระบบแสดงช่วงเวลาให้เลือก (dropdown)
5. ผู้ใช้เลือกช่วงเวลาและคลิก "ดูรายงาน"
6. ระบบสร้างรายงานประกอบด้วย:
   - สรุปภาพรวม (ตัวเลขสำคัญ)
   - กราฟแนวโน้ม (Line Chart)
   - กราฟสัดส่วนตามประเภทกิจกรรม (Pie Chart)
   - ตารางรายละเอียดรายวัน
   - คำแนะนำการปรับปรุง (Recommendations)
7. ระบบแสดงการเปรียบเทียบ:
   - กับช่วงเวลาก่อนหน้า
   - กับเป้าหมายที่ตั้งไว้ (ถ้ามี)
   - กับค่าเฉลี่ยของกลุ่มเดียวกัน
8. ระบบแสดงปุ่ม "แชร์รายงาน" และ "ส่งออก PDF"

### Alternative Flows:
**6a. Insufficient Data:**
- 6a.1 ข้อมูลน้อยกว่า 3 วัน
- 6a.2 แสดงข้อความ "บันทึกข้อมูลอย่างน้อย 3 วัน เพื่อดูรายงาน"
- 6a.3 แสดงปุ่ม "ไปบันทึกข้อมูล"

**8a. Share Report:**
- 8a.1 ผู้ใช้คลิก "แชร์รายงาน"
- 8a.2 แสดง popup เลือกช่องทางแชร์
- 8a.3 สร้าง summary image และ link

**8b. Export PDF:**
- 8b.1 ผู้ใช้คลิก "ส่งออก PDF"
- 8b.2 ระบบสร้างไฟล์ PDF
- 8b.3 ดาวน์โหลดไฟล์ให้ผู้ใช้

### Postconditions:
- ผู้ใช้เข้าใจผลงานของตนเองในช่วงที่เลือก
- ผู้ใช้ได้รับคำแนะนำการปรับปรุง
- ผู้ใช้สามารถแชร์ผลงานได้ (ถ้าต้องการ)
